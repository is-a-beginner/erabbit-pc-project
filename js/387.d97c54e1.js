"use strict";(self["webpackChunkerabbit_pc_project"]=self["webpackChunkerabbit_pc_project"]||[]).push([[387],{1787:function(t,e,s){s.d(e,{IA:function(){return l},ZI:function(){return n},lK:function(){return c},t5:function(){return o},z$:function(){return r}});var a=s(4471);const l=t=>(0,a.Z)("/goods","get",{id:t}),n=(t,e=16)=>(0,a.Z)("/goods/relevant","get",{id:t,limit:e}),c=({id:t,type:e,limit:s=3})=>(0,a.Z)("/goods/hot","get",{id:t,type:e,limit:s}),o=t=>(0,a.Z)(`https://mock.boxuegu.com/mock/1175/goods/${t}/evaluate`,"get"),r=(t,e)=>(0,a.Z)(`https://mock.boxuegu.com/mock/1175/goods/${t}/evaluate/page`,"get",{params:e})},8391:function(t,e,s){var a=s(3396),l=s(9242),n=s(5435);const c=document.createElement("div");c.setAttribute("class","xtx-message-container"),document.body.appendChild(c);let o=null;e["Z"]=({type:t,text:e})=>{const s=(0,a.Wm)(n["default"],{type:t,text:e});(0,l.sY)(s,c),clearTimeout(o),o=setTimeout((()=>{(0,l.sY)(null,c)}),3e3)}},9197:function(t,e,s){s.r(e),s.d(e,{default:function(){return Zt}});var a=s(3396),l=s(7139);const n=t=>((0,a.dD)("data-v-ad858072"),t=t(),(0,a.Cn)(),t),c={class:"xtx-cart-page"},o={class:"container"},r={class:"cart"},u={width:"120"},d=n((()=>(0,a._)("th",{width:"400"},"商品信息",-1))),i=n((()=>(0,a._)("th",{width:"220"},"单价",-1))),p=n((()=>(0,a._)("th",{width:"180"},"数量",-1))),g=n((()=>(0,a._)("th",{width:"180"},"小计",-1))),h=n((()=>(0,a._)("th",{width:"140"},"操作",-1))),k={key:0},_={colspan:"6"},m={class:"goods"},v=["src"],f={class:"name ellipsis"},w={class:"tc"},C={key:0},y={class:"red"},b={class:"tc"},x={class:"tc"},I={class:"f16 red"},D={class:"tc"},Z=n((()=>(0,a._)("p",null,[(0,a._)("a",{href:"javascript:;"},"移入收藏夹")],-1))),S=["onClick"],$=n((()=>(0,a._)("p",null,[(0,a._)("a",{href:"javascript:;"},"找相似")],-1))),z={key:0},W=n((()=>(0,a._)("tr",null,[(0,a._)("td",{colspan:"6"},[(0,a._)("h3",{class:"tit"},"失效商品")])],-1))),j={class:"goods"},T=["src"],E={class:"name ellipsis"},H={class:"attr"},A={class:"tc"},P={class:"tc"},Y={class:"tc"},U=n((()=>(0,a._)("td",{class:"tc"},[(0,a._)("p",null,[(0,a._)("a",{class:"green",href:"javascript:;"},"删除")]),(0,a._)("p",null,[(0,a._)("a",{href:"javascript:;"},"找相似")])],-1))),X={class:"action"},V={class:"batch"},N=n((()=>(0,a._)("a",{href:"javascript:;"},"移入收藏夹",-1))),G={class:"total"},K={class:"red"};function q(t,e,s,n,q,B){const L=(0,a.up)("XtxBreadItem"),R=(0,a.up)("XtxBread"),M=(0,a.up)("XtxCheckbox"),O=(0,a.up)("CartNone"),F=(0,a.up)("RouterLink"),J=(0,a.up)("CartSku"),Q=(0,a.up)("XtxNumbox"),tt=(0,a.up)("XtxButton"),et=(0,a.up)("GoodRelevant");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("div",o,[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,{to:"/"},{default:(0,a.w5)((()=>[(0,a.Uk)("首页")])),_:1}),(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[(0,a.Uk)("购物车")])),_:1})])),_:1}),(0,a._)("div",r,[(0,a._)("table",null,[(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",u,[(0,a.Wm)(M,{onChange:n.checkAll,modelValue:t.$store.getters["cart/isCheckAll"]},{default:(0,a.w5)((()=>[(0,a.Uk)("全选")])),_:1},8,["onChange","modelValue"])]),d,i,p,g,h])]),(0,a._)("tbody",null,[0===t.$store.getters["cart/validList"].length?((0,a.wg)(),(0,a.iD)("tr",k,[(0,a._)("td",_,[(0,a.Wm)(O)])])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.$store.getters["cart/validList"],(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.skuId},[(0,a._)("td",null,[(0,a.Wm)(M,{onChange:e=>n.checkOne(t.skuId,e),modelValue:t.selected},null,8,["onChange","modelValue"])]),(0,a._)("td",null,[(0,a._)("div",m,[(0,a.Wm)(F,{to:`/product/${t.id}`},{default:(0,a.w5)((()=>[(0,a._)("img",{src:t.picture,alt:""},null,8,v)])),_:2},1032,["to"]),(0,a._)("div",null,[(0,a._)("p",f,(0,l.zw)(t.name),1),(0,a.Wm)(J,{onChange:e=>n.updataCartSku(t.skuId,e),skuId:t.skuId,attrsText:t.attrsText},null,8,["onChange","skuId","attrsText"])])])]),(0,a._)("td",w,[(0,a._)("p",null,"¥"+(0,l.zw)(t.nowPrice),1),t.price-t.nowPrice>0?((0,a.wg)(),(0,a.iD)("p",C,[(0,a.Uk)("比加入时降价 "),(0,a._)("span",y,"¥"+(0,l.zw)(t.price-t.nowPrice),1)])):(0,a.kq)("",!0)]),(0,a._)("td",b,[(0,a.Wm)(Q,{onChange:e=>n.updataCount(t.skuId,e),max:t.stock,modelValue:t.count},null,8,["onChange","max","modelValue"])]),(0,a._)("td",x,[(0,a._)("p",I,"¥"+(0,l.zw)(Math.round(100*t.nowPrice)*t.count/100),1)]),(0,a._)("td",D,[Z,(0,a._)("p",null,[(0,a._)("a",{onClick:e=>n.deleteCart(t.skuId),class:"green",href:"javascript:;"},"删除",8,S)]),$])])))),128))]),t.$store.getters["cart/invalidList"].length?((0,a.wg)(),(0,a.iD)("tbody",z,[W,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.$store.getters["cart/invalidList"],(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.skuId},[(0,a._)("td",null,[(0,a.Wm)(M,{style:{color:"#eee"}})]),(0,a._)("td",null,[(0,a._)("div",j,[(0,a.Wm)(F,{to:`/product/${t.id}`},{default:(0,a.w5)((()=>[(0,a._)("img",{src:t.picture,alt:""},null,8,T)])),_:2},1032,["to"]),(0,a._)("div",null,[(0,a._)("p",E,(0,l.zw)(t.name),1),(0,a._)("p",H,(0,l.zw)(t.attrsText),1)])])]),(0,a._)("td",A,[(0,a._)("p",null,"¥"+(0,l.zw)(t.nowPrice),1)]),(0,a._)("td",P,(0,l.zw)(t.count),1),(0,a._)("td",Y,[(0,a._)("p",null,"¥"+(0,l.zw)(Math.round(100*t.nowPrice)*t.count/100),1)]),U])))),128))])):(0,a.kq)("",!0)])]),(0,a._)("div",X,[(0,a._)("div",V,[(0,a.Wm)(M,{onChange:n.checkAll,modelValue:t.$store.getters["cart/isCheckAll"]},{default:(0,a.w5)((()=>[(0,a.Uk)("全选")])),_:1},8,["onChange","modelValue"]),(0,a._)("a",{onClick:e[0]||(e[0]=t=>n.batchDeleteCart()),href:"javascript:;"},"删除商品"),N,(0,a._)("a",{onClick:e[1]||(e[1]=t=>n.batchDeleteCart(!0)),href:"javascript:;"},"清空失效商品")]),(0,a._)("div",G,[(0,a.Uk)(" 共 "+(0,l.zw)(t.$store.getters["cart/validTotal"])+" 件商品，已选择 "+(0,l.zw)(t.$store.getters["cart/selectedTotal"])+" 件，商品合计： ",1),(0,a._)("span",K,"¥"+(0,l.zw)(t.$store.getters["cart/selectedAmount"]),1),(0,a.Wm)(tt,{type:"primary",onClick:e[2]||(e[2]=t=>n.goCheckout())},{default:(0,a.w5)((()=>[(0,a.Uk)("下单结算")])),_:1})])]),(0,a.Wm)(et)])])}s(7658);var B=s(9245),L=s.p+"img/none.243beb2a.png";const R=t=>((0,a.dD)("data-v-2a071270"),t=t(),(0,a.Cn)(),t),M={class:"cart-none"},O=R((()=>(0,a._)("img",{src:L,alt:""},null,-1))),F=R((()=>(0,a._)("p",null,"购物车内暂时没有商品",-1))),J={class:"btn"};function Q(t,e,s,l,n,c){const o=(0,a.up)("XtxButton");return(0,a.wg)(),(0,a.iD)("div",M,[O,F,(0,a._)("div",J,[(0,a.Wm)(o,{type:"primary",onClick:e[0]||(e[0]=e=>t.$router.push("/"))},{default:(0,a.w5)((()=>[(0,a.Uk)("继续逛逛")])),_:1})])])}var tt={name:"CartNone"},et=s(89);const st=(0,et.Z)(tt,[["render",Q],["__scopeId","data-v-2a071270"]]);var at=st,lt=s(65),nt=(s(1703),s(9242)),ct=s(8153);const ot=document.createElement("div");ot.setAttribute("class","xtx-confirm-container"),document.body.appendChild(ot);var rt=({title:t,text:e})=>new Promise(((s,l)=>{const n=()=>{(0,nt.sY)(null,ot),s()},c=()=>{(0,nt.sY)(null,ot),l(new Error("点击取消"))},o=(0,a.Wm)(ct["default"],{title:t,text:e,submitCallback:n,cancelCallback:c});(0,nt.sY)(o,ot)})),ut=s(8391);const dt=t=>((0,a.dD)("data-v-33a417ef"),t=t(),(0,a.Cn)(),t),it={class:"cart-sku",ref:"target"},pt={class:"ellipsis"},gt=dt((()=>(0,a._)("i",{class:"iconfont icon-angle-down"},null,-1))),ht={key:0,class:"layer"},kt={key:0,class:"loading"};function _t(t,e,s,n,c,o){const r=(0,a.up)("Goodsku"),u=(0,a.up)("XtxButton");return(0,a.wg)(),(0,a.iD)("div",it,[(0,a._)("div",{class:"attrs",onClick:e[0]||(e[0]=t=>n.toggle())},[(0,a._)("span",pt,(0,l.zw)(s.attrsText),1),gt]),n.visible?((0,a.wg)(),(0,a.iD)("div",ht,[n.loading?((0,a.wg)(),(0,a.iD)("div",kt)):((0,a.wg)(),(0,a.j4)(r,{key:1,onChange:n.changeSku,skuId:s.skuId,goods:n.goods},null,8,["onChange","skuId","goods"])),n.loading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:2,onClick:e[1]||(e[1]=t=>n.submit()),type:"primary",size:"mini",style:{"margin-left":"60px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("确认")])),_:1}))])):(0,a.kq)("",!0)],512)}var mt=s(4870),vt=s(8401),ft=s(6624),wt=s(5942),Ct={name:"CartSku",components:{Goodsku:wt.Z},props:{attrsText:{Type:String,default:""},skuId:{Type:String,default:""}},setup(t,{emit:e}){const s=(0,mt.iH)(!1),a=(0,mt.iH)(null),l=(0,mt.iH)(!1),n=()=>{s.value=!0,l.value=!0,(0,ft.Kx)(t.skuId).then((t=>{a.value=t.result,l.value=!1}))},c=()=>{s.value=!1},o=()=>{s.value?c():n()},r=(0,mt.iH)(null);(0,vt.i9)(r,(()=>{c()}));const u=(0,mt.iH)(null),d=t=>{u.value=t},i=()=>{u.value&&u.value.skuId&&u.value.skuId!==t.skuId&&(e("change",u.value),c())};return{visible:s,toggle:o,target:r,goods:a,loading:l,currSku:u,changeSku:d,submit:i}}};const yt=(0,et.Z)(Ct,[["render",_t],["__scopeId","data-v-33a417ef"]]);var bt=yt,xt=s(2483),It={name:"XtxCartPage",components:{GoodRelevant:B.Z,CartNone:at,CartSku:bt},setup(){const t=(0,lt.oR)(),e=(e,s)=>{t.dispatch("cart/updateCart",{skuId:e,selected:s})},s=e=>{t.dispatch("cart/checkAllCart",e)},a=e=>{rt({text:"亲， 您是否确认删除商品"}).then((()=>{t.dispatch("cart/deleteCart",e).then((()=>{(0,ut.Z)({type:"success",text:"删除成功"})}))})).catch((t=>{}))},l=e=>{rt({text:`您确定从购物车删除${e?"失效":"选中"}的商品吗？`}).then((()=>{t.dispatch("cart/batchDeleteCart",e).then((()=>{(0,ut.Z)({type:"success",text:"删除成功"})}))})).catch((t=>{}))},n=(e,s)=>{t.dispatch("cart/updateCart",{skuId:e,count:s})},c=(e,s)=>{t.dispatch("cart/updataCartSku",{oldSkuId:e,newSku:s})},o=(0,xt.tv)(),r=()=>{if(0===t.getters["cart/selectedTotal"])return(0,ut.Z)({text:"至少选中一件商品才能结算"});t.state.user.profile.token?o.push("/member/checkout"):rt({text:"下单结算需要登录，您是否去登录？"}).then((()=>{o.push("/member/checkout")})).catch((t=>{}))};return{checkOne:e,checkAll:s,deleteCart:a,batchDeleteCart:l,updataCount:n,updataCartSku:c,goCheckout:r}}};const Dt=(0,et.Z)(It,[["render",q],["__scopeId","data-v-ad858072"]]);var Zt=Dt},9245:function(t,e,s){s.d(e,{Z:function(){return m}});var a=s(3396),l=s(7139);const n=t=>((0,a.dD)("data-v-66d0f2da"),t=t(),(0,a.Cn)(),t),c={class:"goods-relevant"},o={class:"header"},r=n((()=>(0,a._)("i",{class:"icon"},null,-1))),u={class:"title"};function d(t,e,s,n,d,i){const p=(0,a.up)("XtxCarousel");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("div",o,[r,(0,a._)("span",u,(0,l.zw)(s.goodsId?"同类商品推荐":"猜你喜欢"),1)]),(0,a.Wm)(p,{sliders:n.sliders,style:{height:"380px"},"auto-play":""},null,8,["sliders"])])}s(7658);var i=s(1787),p=s(4870);const g=t=>{const e=(0,p.iH)([]);return(0,i.ZI)(t).then((t=>{const s=4,a=Math.ceil(t.result.length/s);for(let l=0;l<a;l++)e.value.push(t.result.slice(l*s,(l+1)*s))})),e};var h={name:"GoodsRelevant",props:{goodsId:{type:String,default:void 0}},setup(t){const e=g(t.goodsId);return{sliders:e}}},k=s(89);const _=(0,k.Z)(h,[["render",d],["__scopeId","data-v-66d0f2da"]]);var m=_},5942:function(t,e,s){s.d(e,{Z:function(){return v}});var a=s(3396),l=s(7139);const n={class:"goods-sku"},c=["onClick","src","title"],o=["onClick"];function r(t,e,s,r,u,d){return(0,a.wg)(),(0,a.iD)("div",n,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.goods.specs,(t=>((0,a.wg)(),(0,a.iD)("dl",{key:t.id},[(0,a._)("dt",null,(0,l.zw)(t.name),1),(0,a._)("dd",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.values,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.name},[e.picture?((0,a.wg)(),(0,a.iD)("img",{key:0,class:(0,l.C_)({selected:e.selected,disabled:e.disabled}),onClick:s=>r.clickSpecs(t,e),src:e.picture,title:e.name},null,10,c)):((0,a.wg)(),(0,a.iD)("span",{key:1,class:(0,l.C_)({selected:e.selected,disabled:e.disabled}),onClick:s=>r.clickSpecs(t,e)},(0,l.zw)(e.name),11,o))],64)))),128))])])))),128))])}s(7658);function u(t){const e=[],s=2**t.length;for(let a=0;a<s;a+=1){const s=[];for(let e=0;e<t.length;e+=1)a&1<<e&&s.push(t[e]);e.push(s)}return e}const d="★",i=t=>{const e={};return t.forEach((t=>{if(t.inventory>0){const s=t.specs.map((t=>t.valueName)),a=u(s);a.forEach((s=>{const a=s.join(d);e[a]?e[a].push(t.id):e[a]=[t.id]}))}})),e},p=t=>{const e=[];return t.forEach((t=>{const s=t.values.find((t=>t.selected));e.push(s?s.name:void 0)})),e},g=(t,e)=>{t.forEach(((s,a)=>{const l=p(t);s.values.forEach((t=>{if(t.name===l[a])return!1;l[a]=t.name;const s=l.filter((t=>t)).join(d);t.disabled=!e[s]}))}))},h=(t,e)=>{const s=t.skus.find((t=>t.id===e));s&&t.specs.forEach(((t,e)=>{const a=s.specs[e].valueName;t.values.forEach((t=>{t.selected=t.name===a}))}))};var k={name:"GoodsSku",props:{goods:{type:Object,default:()=>({specs:[],skus:[]})},skuId:{type:String,default:""}},setup(t,{emit:e}){const s=i(t.goods.skus);h(t.goods,t.skuId),g(t.goods.specs,s);const a=(a,l)=>{if(l.disabled)return!1;l.selected?l.selected=!1:(a.values.forEach((t=>{t.selected=!1})),l.selected=!0),g(t.goods.specs,s);const n=p(t.goods.specs).filter((t=>t));if(n.length===t.goods.specs.length){const a=s[n.join(d)],l=t.goods.skus.find((t=>t.id===a[0]));e("change",{skuId:l.id,price:l.price,oldPrice:l.oldPrice,inventory:l.inventory,specsText:l.specs.reduce(((t,e)=>`${t} ${e.name}：${e.valueName}`),"").replace(" ","")})}else e("change",{})};return{clickSpecs:a}}},_=s(89);const m=(0,_.Z)(k,[["render",r],["__scopeId","data-v-2a7a5a7f"]]);var v=m}}]);
//# sourceMappingURL=387.d97c54e1.js.map